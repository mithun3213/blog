<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atlas Collective - Cipher Chase</title>
    <link rel="stylesheet" href="../style.css">
    <style>
        /* Specific styles for readability in write-ups */
        .writeup-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .back-link {
            color: #888;
            text-decoration: none;
            font-size: 0.9rem;
            margin-bottom: 20px;
            display: inline-block;
        }
        .back-link:hover { color: #fff; }
        
        /* Code blocks styling */
        pre {
            background: #111;
            border: 1px solid #333;
            padding: 15px;
            overflow-x: auto;
            color: #00ff00;
            margin: 15px 0;
        }
        code {
            background: #222;
            padding: 2px 5px;
            border-radius: 3px;
            color: #ff7b00; /* Orange for inline code */
        }
        pre code {
            background: transparent;
            padding: 0;
            color: #00ff00;
        }

        /* Table styling from your write-up */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: #0a0a0a;
        }
        table, th, td { border: 1px solid #444; }
        th, td { padding: 12px; text-align: left; color: #ccc; }
        th { background-color: #1a1a1a; color: #00ff00; }
    </style>
</head>
<body>

    <div class="writeup-container">
        <a href="../index.html" class="back-link"><< Back to Home</a>

        <h1 style="color: #fff; margin-bottom: 5px;">Atlas Collective - Cipher Chase (CTF)</h1>
        <p style="color: #666; font-size: 0.9rem; margin-bottom: 20px;">Nov 9, 2025</p>
        <hr style="border-color: #333; margin-bottom: 30px;">

        <h3>The Challenge Description:</h3>
        <p>The Atlas Engineering Collective maintains a suite of developer tools inside a protected pocket of the multiverse — a place where prototype assets and "experimental artifacts" are stored while engineers iterate. Yesterday a junior engineer left the <strong>Atlas Dev Node</strong> running with a debug-only artifact route enabled. To make artifacts available to the rest of the stack, the team also deployed <strong>Echo</strong>, a thin gateway that fetches assets from Atlas on demand and is supposed to accept requests only from internal services.</p>
        
        <p>Somewhere in the logs a maintenance account scribbled a placeholder: <code>secrets/atlas_thread.txt</code>. That file contains a dimensional signature you’ll need to claim victory.</p>
        <br>
        <p>Target URL: <a href="http://ctf.iiitb.net:14033/" target="_blank" style="color:#00ff00;">http://ctf.iiitb.net:14033/</a></p>
        <br>
        <p>Source code: </p>
        <br>
        
        <h3>Source Code Analysis</h3>
        <p>They have given the source code. While reading the source code, I came to know that in the <code>main.py</code>:</p>
        <pre><code>def _is_internal(ip: str) -> bool:
    if not ip:
        return False
    return ip.startswith("172.")</code></pre>
        
        <p>This indicates that the IP addresses starting with <code>172.</code> will be accepted as internal. Then, the secret is located by:</p>
        <pre><code>let secret = fs.readFileSync('/srv/atlas/secrets/atlas_thread.txt', 'utf8')</code></pre>

        <h3>Solution</h3>
        <p>At first, I tried changing the path to <code>/artifact</code>, and the result was:</p>
        <br>
        <table>
            <thead>
                <tr><th>Key</th><th>Value</th></tr>
            </thead>
            <tbody>
                <tr><td>detail</td><td></td></tr>
                <tr><td>0</td><td></td></tr>
                <tr><td>loc</td><td></td></tr>
                <tr><td>0</td><td>"query"</td></tr>
                <tr><td>1</td><td>"path"</td></tr>
                <tr><td>msg</td><td>"field required"</td></tr>
                <tr><td>type</td><td>"value_error.missing"</td></tr>
            </tbody>
        </table>
        <br>
        <p>I reread the source code, and to bypass the internal IP check, I used the <strong>X-Forwarded-For</strong> header with a <code>172.</code> IP in Burp Suite: <code>X-Forwarded-For: 172.0.0.1</code>. Then I tried the request path <code>%2F_artifact/secrets/atlas_thread.txt</code>, but it didn't work. By changing the directory using traversal, the successful path was:</p>
        <pre><code>%2F_artifact/../secrets/atlas_thread.txt</code></pre>
        <p>This gave me the flag.</p>
        <br>
        <h3>Flag</h3>
        <pre><code>ZenseCTF{ech0_d3bug_atl@s_thread_sign@ture_LIGHTBRIDGE42}</code></pre>

        </div>

</body>
</html>