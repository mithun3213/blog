<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hacking with Bitwise Logic: Guess the Number Arisu!!</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>

    <nav class="navbar">
        <div class="nav-left">
            <a href="index.html" class="logo">Hopper Blog</a>
        </div>
        <div class="nav-right">
            <a href="writeups.html">‚Üê Back to Write-ups</a>
            <span class="theme-toggle"><i class="fas fa-sun"></i></span> 
        </div>
    </nav>

    <main class="container post-container">
        
        <article class="blog-post">
            <header>
                <p class="post-meta-tag">REV/ CTF</p>
                <h1>EnigmaXplore 3.0 : guess-number-arisu</h1>
                <p class="post-author">By hopper @ NOVA | November 6, 2025</p>
                <hr>
            </header>

            <p>In the world of CTF challenges, sometimes the most robust solutions come from understanding basic mathematical operations in depth. We recently tackled a puzzle called "Guess the Number Arisu!!" The goal was to guess a secret 16-bit number (X), but we only had a tiny number of query attempts.</p>
            <p>The solution? A clever trick using the bitwise OR operation to determine the secret number's upper half and lower half independently.</p>

            <h2 id="challenge">üßê The Challenge: The Power of OR Queries</h2>
            <p>The server held a secret 16-bit number, $X$. Our tool was a query mechanism:</p>
            <ul>
                <li>We could send a list of up to 200 numbers.</li>
                <li>The server would randomly select one of our numbers, $Q$.</li>
                <li>The server would return the result of a bitwise operation between $X$ and $Q$.</li>
            </ul>
            <p>The result was $R = X \text{ OR } Q$. We had to guess $X$ using a maximum of **two queries**. </p>

            <h2 id="weapon">üí° The Secret Weapon: Exploiting the OR Operation</h2>
            <p>The bitwise OR operation is key. The most critical takeaway for us is: **If a bit in $Q$ is 0, the resulting bit in $R$ must be the same as the corresponding bit in $X$.**</p>
            <div class="code-block-inline">
                <pre><code>X's Bit OR 0 = X's Bit</code></pre>
            </div>
            <p>This allows us to selectively "mask" off parts of the number $X$ to reveal its hidden bits.</p>

            <h3 id="phase-1">Phase 1: Finding the Upper 8 Bits (Query 1)</h3>
            <p>A 16-bit number is $AAAAAAAABBBBBBBB$ (Upper 8 / Lower 8). To find the **upper 8 bits** of $X$, we need to ensure the upper 8 bits of our query $Q$ are all **0**.</p>
            
            <p><strong>Our Query List:</strong> We sent a list of numbers from 0 up to 199. Since $199 < 256$, all numbers in our list have the form $00000000\ BBBBBBBB$.</p>
            
            <p><strong>The Result ($R_1$):</strong> The upper 8 bits of the result will be:</p>
            <div class="code-block-inline">
                <pre><code>Upper Bits(X) OR 00000000 = Upper Bits(X)</code></pre>
            </div>
            
            <p><strong>Extraction:</strong> We isolate the upper half of $X$ by masking the result with <code>0xFF00</code> (binary $11111111\ 00000000$):</p>
            <div class="code-block-inline">
                <pre><code>upper_bits = R1 AND 0xFF00</code></pre>
            </div>
            <p>We now know the top half of the secret number!</p>

            <h3 id="phase-2">Phase 2: Finding the Lower 8 Bits (Query 2)</h3>
            <p>Now we need the **lower 8 bits** of $X$. We must ensure that the lower 8 bits of our query number ($Q$) are all **0**.</p>

            <p><strong>Our Query List:</strong> We sent a list of multiples of 256: 0, 256, 512, ... All numbers in this list have the form $AAAAAAA\ 00000000$.</p>

            <p><strong>The Result ($R_2$):</strong> The lower 8 bits of the result will be:</p>
            <div class="code-block-inline">
                <pre><code>Lower Bits(X) OR 00000000 = Lower Bits(X)</code></pre>
            </div>

            <p><strong>Extraction:</strong> We isolate the lower half of $X$ by masking the result with <code>0x00FF</code> (binary $00000000\ 11111111$):</p>
            <div class="code-block-inline">
                <pre><code>lower_bits = R2 AND 0x00FF</code></pre>
            </div>

            <h3 id="phase-3">Phase 3: Assembly</h3>
            <p>With the two halves determined, we simply combine them with a final OR operation:</p>
            <div class="code-block-inline">
                <pre><code>secret_number = upper_bits OR lower_bits</code></pre>
            </div>
            <p>We have successfully rebuilt the 16-bit number $X$ in just two queries!</p>

            <h2 id="pwntools"> The rev Implementation</h2>
            <p>The following script executes this exact plan using a simulated <code>make_query</code> function:</p>
            <div class="code-block-inline">
                <pre><code># Query 1: Determine the upper 8 bits (Q's upper 8 bits are 0)
numbers1 = [i for i in range(200)] 
result1 = make_query(r, numbers1)
upper_bits = result1 & 0xFF00 # Isolate the upper bits of X

# Query 2: Determine the lower 8 bits (Q's lower 8 bits are 0)
numbers2 = [i * 256 for i in range(200)] 
result2 = make_query(r, numbers2)
lower_bits = result2 & 0x00FF # Isolate the lower bits of X

# Assemble and guess
secret_number = upper_bits | lower_bits 
# ... send secret_number to the server ...</code></pre>
            </div>

            <h2 id="flag">The Flag</h2>
            <p>The successful execution yielded the flag:</p>
            <div class="final-flag-block">
                <pre><code>EnXp{L0RD_TT_TH4_G04T}</code></pre>
            </div>

        </article>
    </main>
</body>
</html>